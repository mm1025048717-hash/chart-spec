<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é•¿æ–‡å­—45åº¦+æˆªæ–­ - Xè½´æ–‡å­—ä¼˜åŒ–æ–¹æ¡ˆ</title>
    <script src="https://cdn.jsdelivr.net/npm/@antv/g2plot@2.4.31/dist/g2plot.min.js"></script>
    <link rel="stylesheet" href="../../common.css">
    <style>
        .scenario-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: linear-gradient(135deg, #FFF7E6 0%, #FFE7BA 100%);
            padding: 8px 16px;
            border-radius: 20px;
            margin-bottom: 24px;
        }
        .scenario-badge .icon {
            width: 24px;
            height: 24px;
            background: #D48806;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: bold;
        }
        .scenario-badge .text {
            font-size: 14px;
            color: #D48806;
            font-weight: 500;
        }

        .key-point {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: #FFF7E6;
            color: #D48806;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 13px;
            margin: 4px;
        }
        .key-point::before {
            content: 'âœ“';
            font-weight: bold;
        }

        .truncate-demo {
            background: #FAFBFC;
            border-radius: 8px;
            padding: 24px;
            margin: 20px 0;
        }
        .truncate-example {
            display: flex;
            align-items: center;
            gap: 20px;
            margin: 12px 0;
            padding: 12px;
            background: white;
            border-radius: 6px;
            border: 1px solid var(--border);
        }
        .truncate-original {
            flex: 1;
            font-family: 'SF Mono', monospace;
            font-size: 13px;
            color: var(--text);
        }
        .truncate-arrow {
            color: var(--yellow);
            font-size: 20px;
        }
        .truncate-result {
            flex: 1;
            font-family: 'SF Mono', monospace;
            font-size: 13px;
            color: var(--yellow);
            font-weight: 600;
        }
        .truncate-length {
            background: #FFF7E6;
            color: #D48806;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 20px 0;
        }
        @media (max-width: 768px) {
            .comparison-grid { grid-template-columns: 1fr; }
        }
        .comparison-item {
            background: #FAFBFC;
            border-radius: 8px;
            padding: 16px;
            border: 1px solid var(--border);
        }
        .comparison-item h4 {
            font-size: 13px;
            color: var(--text-sub);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .comparison-item h4 .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }
        .comparison-item.good h4 .dot { background: var(--green); }
        .comparison-item.bad h4 .dot { background: var(--red); }

        .data-preview {
            background: #1F2329;
            border-radius: 6px;
            padding: 12px;
            font-family: 'SF Mono', monospace;
            font-size: 11px;
            color: #E6E8EB;
            overflow-x: auto;
        }

        .tooltip-demo {
            background: white;
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 12px 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            display: inline-block;
            margin: 16px 0;
        }
        .tooltip-demo-title {
            font-size: 11px;
            color: var(--text-sub);
            margin-bottom: 8px;
        }
        .tooltip-demo-content {
            font-size: 13px;
            color: var(--text);
        }
        .tooltip-demo-value {
            font-weight: 600;
            color: var(--blue);
        }
    </style>
</head>
<body>

<div class="page-header">
    <div class="scenario-badge">
        <span class="icon">3</span>
        <span class="text">åœºæ™¯ä¸‰ï¼šé•¿æ–‡å­—æˆªæ–­æ˜¾ç¤º</span>
    </div>
    <h1>é•¿æ–‡å­— (>8è§†è§‰å®½åº¦) - 45Â°+æˆªæ–­</h1>
    <p class="subtitle">é€‚ç”¨äºé•¿æ ‡ç­¾å¦‚ï¼šiPhone 15 Proã€MacBook Air M2ã€åä¸º Mate 60 Pro ç­‰</p>
    <div class="tech-stack">
        <span class="tech-tag">Ant Design Chart</span>
        <span class="tech-tag">G2Plot</span>
        <span class="tech-tag">rotate: -45Â° + truncate: 8</span>
    </div>
</div>

<!-- æˆªæ–­æ¼”ç¤º -->
<div class="spec-section">
    <div class="spec-title">æˆªæ–­æ•ˆæœæ¼”ç¤º</div>
    
    <div class="truncate-demo">
        <div class="truncate-example">
            <div class="truncate-original">"iPhone 15 Pro"</div>
            <div class="truncate-length">13å­—ç¬¦</div>
            <div class="truncate-arrow">â†’</div>
            <div class="truncate-result">"iPhone 1..."</div>
        </div>
        <div class="truncate-example">
            <div class="truncate-original">"MacBook Air M2"</div>
            <div class="truncate-length">14å­—ç¬¦</div>
            <div class="truncate-arrow">â†’</div>
            <div class="truncate-result">"MacBook ..."</div>
        </div>
        <div class="truncate-example">
            <div class="truncate-original">"åä¸º Mate 60 Pro"</div>
            <div class="truncate-length">14å­—ç¬¦</div>
            <div class="truncate-arrow">â†’</div>
            <div class="truncate-result">"åä¸º Mate..."</div>
        </div>
        <div class="truncate-example">
            <div class="truncate-original">"Apple Watch Series 9"</div>
            <div class="truncate-length">20å­—ç¬¦</div>
            <div class="truncate-arrow">â†’</div>
            <div class="truncate-result">"Apple Wa..."</div>
        </div>
    </div>

    <div style="background: #E6F7F0; padding: 12px 16px; border-radius: 6px; font-size: 13px; color: #00A854;">
        ğŸ’¡ <b>Tooltipå®Œæ•´æ˜¾ç¤º</b>ï¼šè™½ç„¶Xè½´æ ‡ç­¾è¢«æˆªæ–­ï¼Œä½†é¼ æ ‡æ‚¬æµ®æ—¶Tooltipä¼šæ˜¾ç¤ºå®Œæ•´çš„äº§å“åç§°ã€‚
    </div>
</div>

<!-- è®¾è®¡è§„èŒƒè¯´æ˜ -->
<div class="spec-section">
    <div class="spec-title">é€‚ç”¨åœºæ™¯ä¸åˆ¤æ–­æ¡ä»¶</div>
    
    <div class="comparison-grid">
        <div class="comparison-item good">
            <h4><span class="dot"></span>é€‚ç”¨æ•°æ®ç¤ºä¾‹</h4>
            <div class="data-preview">
[
  { product: 'iPhone 15 Pro', value: 72000 },     <span style="color:#6A737D;">// 13å­—ç¬¦</span>
  { product: 'MacBook Air M2', value: 45000 },   <span style="color:#6A737D;">// 14å­—ç¬¦</span>
  { product: 'iPad Pro 12.9', value: 38000 },    <span style="color:#6A737D;">// 13å­—ç¬¦</span>
  { product: 'Apple Watch S9', value: 28000 },   <span style="color:#6A737D;">// 14å­—ç¬¦</span>
]
            </div>
        </div>
        <div class="comparison-item bad">
            <h4><span class="dot"></span>è€ƒè™‘å…¶ä»–åœºæ™¯</h4>
            <div class="data-preview">
<span style="color:#6A737D;">// æ–‡å­—å¤ªçŸ­ â†’ åœºæ™¯1æˆ–2</span>
{ product: 'åä¸œ', value: 3650 }

<span style="color:#6A737D;">// æ–‡å­—è¶…é•¿(â‰¥50å­—ç¬¦) â†’ åœºæ™¯4 (90åº¦)</span>
{ product: 'MacBook Pro 16è‹±å¯¸ M3 Max é¡¶é…ç‰ˆ...', value: 120000 }

<span style="color:#6A737D;">// æ•°æ®é¡¹å¤ªå¤š(â‰¥15) â†’ åœºæ™¯6</span>
[... 20ä¸ªæ•°æ®é¡¹ ...]
            </div>
        </div>
    </div>

    <div class="spec-title">è§¦å‘æ¡ä»¶</div>
    <table class="spec-table">
        <thead>
            <tr>
                <th style="width: 180px;">æ¡ä»¶</th>
                <th style="width: 150px;">é˜ˆå€¼</th>
                <th>è¯´æ˜</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><b>æœ€å¤§è§†è§‰å®½åº¦</b></td>
                <td><code>> 8 ä¸” < 50</code></td>
                <td>è¶…è¿‡8ä½†ä¸åˆ°50ï¼ˆè¶…é•¿é˜ˆå€¼ï¼‰</td>
            </tr>
            <tr>
                <td><b>æ•°æ®é¡¹æ•°é‡</b></td>
                <td><code>< 15</code></td>
                <td>å°‘äº15é¡¹æ—¶ä½¿ç”¨45åº¦</td>
            </tr>
            <tr class="highlight">
                <td><b>æˆªæ–­å­—ç¬¦æ•°</b></td>
                <td><code>8</code></td>
                <td>æˆªæ–­åæ˜¾ç¤ºå‰8ä¸ªå­—ç¬¦ + "..."</td>
            </tr>
        </tbody>
    </table>

    <div style="margin-top: 16px;">
        <span class="key-point">45åº¦å€¾æ–œ</span>
        <span class="key-point">æˆªæ–­åˆ°8å­—ç¬¦</span>
        <span class="key-point">æ·»åŠ çœç•¥å·"..."</span>
        <span class="key-point">Tooltipæ˜¾ç¤ºå®Œæ•´</span>
    </div>
</div>

<!-- æ ¸å¿ƒé…ç½®ä»£ç  -->
<div class="spec-section">
    <div class="spec-title">æ ¸å¿ƒé…ç½®ä»£ç </div>
    <div class="code-block">
<span class="comment">// é•¿æ–‡å­—åœºæ™¯é…ç½®ï¼ˆ45Â° + æˆªæ–­ï¼‰</span>
<span class="keyword">const</span> xAxisConfig = {
    label: {
        autoRotate: <span class="keyword">false</span>,
        rotate: -Math.PI / <span class="number">4</span>,          <span class="comment">// -45åº¦</span>
        formatter: (text) => {
            <span class="keyword">const</span> maxLength = <span class="number">8</span>;         <span class="comment">// æˆªæ–­é•¿åº¦</span>
            <span class="keyword">if</span> (text.length > maxLength) {
                <span class="keyword">return</span> text.substring(<span class="number">0</span>, maxLength) + <span class="string">'...'</span>;
            }
            <span class="keyword">return</span> text;
        },
        style: {
            fontSize: <span class="number">11</span>,
            fill: <span class="string">'#646A73'</span>,
            textAlign: <span class="string">'end'</span>,
        },
    },
};

<span class="comment">// Tooltipé…ç½®ï¼šæ˜¾ç¤ºå®Œæ•´æ–‡å­—</span>
<span class="keyword">const</span> tooltipConfig = {
    formatter: (datum) => ({
        name: datum.product,  <span class="comment">// å®Œæ•´äº§å“åï¼Œä¸æˆªæ–­</span>
        value: datum.value.toLocaleString() + <span class="string">' ä¸‡å…ƒ'</span>,
    }),
};
    </div>
</div>

<!-- Tooltipè¯´æ˜ -->
<div class="spec-section">
    <div class="spec-title">Tooltip å®Œæ•´æ˜¾ç¤º</div>
    
    <p style="margin-bottom: 16px; color: var(--text-sub);">
        æˆªæ–­åªå½±å“Xè½´æ ‡ç­¾æ˜¾ç¤ºï¼ŒTooltipï¼ˆé¼ æ ‡æ‚¬æµ®æç¤ºï¼‰ä»ç„¶æ˜¾ç¤ºå®Œæ•´å†…å®¹ï¼š
    </p>
    
    <div class="tooltip-demo">
        <div class="tooltip-demo-title">iPhone 15 Pro</div>
        <div class="tooltip-demo-content">
            é”€é‡: <span class="tooltip-demo-value">72,000 ä¸‡å…ƒ</span>
        </div>
    </div>
    
    <div class="code-block" style="margin-top: 16px;">
<span class="comment">// Tooltip ä½¿ç”¨åŸå§‹æ•°æ®ï¼Œä¸å— formatter å½±å“</span>
tooltip: {
    formatter: (datum) => ({
        name: datum.product,     <span class="comment">// â† è¿™é‡Œç”¨åŸå§‹å­—æ®µå€¼</span>
        value: datum.value.toLocaleString() + <span class="string">' ä¸‡å…ƒ'</span>,
    }),
}
    </div>
</div>

<!-- å›¾è¡¨å±•ç¤º -->
<div class="chart-container">
    <div class="chart-card">
        <div class="chart-card-header">
            <span class="chart-title">äº§å“é”€é‡æ’è¡Œï¼ˆé•¿äº§å“åç§°ï¼‰</span>
            <span class="chart-tag yellow">truncate: 8å­—ç¬¦</span>
        </div>
        <div class="chart-body md">
            <div class="axis-unit y-left">ä¸‡å…ƒ</div>
            <div id="chart-main" style="width: 100%; height: 100%;"></div>
        </div>
        <div class="chart-summary">
            æ•°æ®é¡¹ï¼š<strong>5é¡¹</strong> | æœ€é•¿æ–‡å­—ï¼š<strong>14å­—ç¬¦</strong> | æˆªæ–­é•¿åº¦ï¼š<strong>8å­—ç¬¦</strong> | Tooltipï¼š<strong>å®Œæ•´æ˜¾ç¤º âœ“</strong>
        </div>
    </div>
</div>

<!-- é…ç½®å‚æ•°è¯¦è§£ -->
<div class="spec-section">
    <div class="spec-title">å®Œæ•´é…ç½®å‚æ•°</div>
    <table class="spec-table">
        <thead>
            <tr>
                <th style="width: 160px;">å‚æ•°</th>
                <th style="width: 140px;">å€¼</th>
                <th style="width: 100px;">ç±»å‹</th>
                <th>è¯´æ˜</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><code>rotate</code></td>
                <td><code>-Math.PI/4</code></td>
                <td>number</td>
                <td>-45åº¦æ—‹è½¬</td>
            </tr>
            <tr class="highlight">
                <td><code>formatter</code></td>
                <td><code>truncate(8)</code></td>
                <td>function</td>
                <td>æˆªæ–­å‡½æ•°ï¼Œä¿ç•™8å­—ç¬¦</td>
            </tr>
            <tr>
                <td><code>textAlign</code></td>
                <td><code>'end'</code></td>
                <td>string</td>
                <td>æ—‹è½¬æ—¶å³å¯¹é½</td>
            </tr>
            <tr>
                <td><code>fontSize</code></td>
                <td><code>11</code></td>
                <td>number</td>
                <td>å­—ä½“å¤§å°</td>
            </tr>
        </tbody>
    </table>
</div>

<!-- æˆªæ–­å­—ç¬¦æ•°é€‰æ‹© -->
<div class="spec-section">
    <div class="spec-title">ä¸ºä»€ä¹ˆæˆªæ–­åˆ°8ä¸ªå­—ç¬¦ï¼Ÿ</div>
    <table class="spec-table">
        <thead>
            <tr>
                <th style="width: 150px;">æˆªæ–­é•¿åº¦</th>
                <th style="width: 200px;">æ•ˆæœç¤ºä¾‹</th>
                <th>è¯„ä»·</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>4å­—ç¬¦</td>
                <td>iPho...</td>
                <td>âŒ ä¿¡æ¯ä¸¢å¤±å¤ªå¤šï¼Œéš¾ä»¥è¾¨è¯†</td>
            </tr>
            <tr>
                <td>6å­—ç¬¦</td>
                <td>iPhone...</td>
                <td>âš ï¸ å‹‰å¼ºå¯è¾¨è¯†ï¼Œ90Â°æ—¶ä½¿ç”¨</td>
            </tr>
            <tr class="highlight">
                <td><b>8å­—ç¬¦</b></td>
                <td>iPhone 1...</td>
                <td>âœ“ æœ€ä½³å¹³è¡¡ï¼Œ45Â°æ—¶æ¨è</td>
            </tr>
            <tr>
                <td>10å­—ç¬¦</td>
                <td>iPhone 15 ...</td>
                <td>âš ï¸ å ç”¨ç©ºé—´è¾ƒå¤§</td>
            </tr>
            <tr>
                <td>12å­—ç¬¦</td>
                <td>iPhone 15 Pr...</td>
                <td>âŒ å‡ ä¹æ²¡æœ‰æˆªæ–­å¿…è¦</td>
            </tr>
        </tbody>
    </table>
</div>

<!-- è¾¹ç•Œæƒ…å†µ -->
<div class="spec-section">
    <div class="spec-title">è¾¹ç•Œæƒ…å†µå¤„ç†</div>
    <table class="spec-table">
        <thead>
            <tr>
                <th style="width: 200px;">æƒ…å†µ</th>
                <th style="width: 150px;">å¤„ç†æ–¹å¼</th>
                <th>è¯´æ˜</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>æ–‡å­—åˆšå¥½8å­—ç¬¦</td>
                <td>ä¸æˆªæ–­</td>
                <td>ç­‰äºé˜ˆå€¼æ—¶ä¸éœ€è¦æˆªæ–­</td>
            </tr>
            <tr>
                <td>æ–‡å­—9å­—ç¬¦</td>
                <td>æˆªæ–­åˆ°8 + "..."</td>
                <td>è¶…è¿‡å°±æˆªæ–­</td>
            </tr>
            <tr>
                <td>ç©ºå­—ç¬¦ä¸²æˆ–null</td>
                <td>åŸæ ·è¿”å›</td>
                <td>formatteråº”åšç©ºå€¼ä¿æŠ¤</td>
            </tr>
            <tr class="highlight">
                <td>å­—ç¬¦â‰¥50</td>
                <td><b>åˆ‡æ¢åˆ°90Â°</b></td>
                <td>è¶…é•¿æ–‡å­—ä½¿ç”¨åœºæ™¯4</td>
            </tr>
            <tr class="highlight">
                <td>æ•°æ®é¡¹â‰¥15</td>
                <td><b>åˆ‡æ¢åˆ°90Â°</b></td>
                <td>æ•°æ®å¤ªå¤šä½¿ç”¨åœºæ™¯6</td>
            </tr>
        </tbody>
    </table>
</div>

<script>
const { Column } = G2Plot;

// é•¿æ–‡å­—æ•°æ®
const data = [
    { product: 'iPhone 15 Pro', value: 72000 },
    { product: 'MacBook Air M2', value: 45000 },
    { product: 'iPad Pro 12.9', value: 38000 },
    { product: 'Apple Watch S9', value: 28000 },
    { product: 'AirPods Pro 2', value: 21000 },
];

// æˆªæ–­å‡½æ•°
function truncate(text, maxLength = 8) {
    const str = String(text || '');
    if (str.length > maxLength) {
        return str.substring(0, maxLength) + '...';
    }
    return str;
}

// è¾“å‡ºæˆªæ–­æ¼”ç¤º
data.forEach(d => {
    console.log(`"${d.product}" (${d.product.length}å­—ç¬¦) â†’ "${truncate(d.product)}"`);
});

new Column('chart-main', {
    data,
    xField: 'product',
    yField: 'value',
    color: '#F6BD16',
    columnWidthRatio: 0.5,
    columnStyle: {
        radius: [4, 4, 0, 0],
    },
    // æ ¸å¿ƒï¼šé•¿æ–‡å­—Xè½´é…ç½®
    xAxis: {
        label: {
            autoRotate: false,
            rotate: -Math.PI / 4,
            formatter: (text) => truncate(text, 8),  // æˆªæ–­åˆ°8å­—ç¬¦
            style: {
                fontSize: 11,
                fill: '#646A73',
                textAlign: 'end',
            },
        },
    },
    yAxis: {
        label: {
            formatter: (v) => (v / 10000).toFixed(0) + 'ä¸‡',
        },
    },
    label: {
        position: 'top',
        style: {
            fill: '#D48806',
            fontSize: 11,
        },
        formatter: (datum) => (datum.value / 10000).toFixed(1) + 'ä¸‡',
    },
    // é‡è¦ï¼šTooltipæ˜¾ç¤ºå®Œæ•´æ–‡å­—
    tooltip: {
        formatter: (datum) => ({
            name: datum.product,  // å®Œæ•´äº§å“å
            value: datum.value.toLocaleString() + ' ä¸‡å…ƒ',
        }),
    },
}).render();
</script>


<script src="../../nav.js"></script>
</body>
</html>
